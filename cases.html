<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BlueBadge â€“ Mini-Case</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <nav class="top-nav">
      <div class="nav-brand"><h1><a href="index.html" style="text-decoration:none; color:inherit;">ðŸš” BlueBadge</a></h1></div>
      <div class="nav-links">
        <a href="index.html">Dashboard</a>
        <a href="simulation.html">SimÃ¼lasyon</a>
      </div>
    </nav>
    <div class="hero-section"><h2>MINI-CASE</h2><p>Senaryo tabanlÄ± karar verme</p></div>
  </header>
  <main style="max-width:900px;margin:24px auto;">
    <section class="test-interface" style="display:block;">
      <div class="test-container">
        <div class="test-header"><div class="test-info"><span id="case-title">...</span><span id="case-step" style="margin-left:auto;">1/1</span></div></div>
        <div class="question-container">
          <div class="question-text" id="case-context">...</div>
          <div class="question-text" id="case-question" style="margin-top:8px;">...</div>
          <div class="question-options" id="case-options"></div>
        </div>
        <div class="test-controls">
          <button class="control-btn secondary" id="case-prev" disabled>Vorige</button>
          <button class="control-btn primary" id="case-next" disabled>Volgende</button>
          <button class="control-btn success" id="case-end" style="display:none;">Einde</button>
        </div>
      </div>
    </section>
  </main>
  <footer>
    <p>Â© 2025 BlueBadge | Classified Training System</p>
  </footer>
  <script src="i18n.js"></script>
  <script>
    let cases = []; let current = null; let step = 0; let answers = []; let score=0;
    async function load(){
      try { const imp = JSON.parse(localStorage.getItem('import_cases')||'[]'); if(Array.isArray(imp)&&imp.length){ cases = imp; } } catch{}
      if (!cases.length){ cases = [ { title:'Gece GÃ¼rÃ¼ltÃ¼', context:'03:00 sularÄ±nda apartmandan yÃ¼ksek ses ÅŸikayeti alÄ±ndÄ±.', vraag:'Ä°lk adÄ±m ne olmalÄ±?', opties:['Hemen ceza yaz','Yerinde durum deÄŸerlendirmesi','ÅžikayetÃ§iyi azarla','Bekle'], best:1, uitleg:'Ã–nce yerinde durum deÄŸerlendirmesi yapÄ±lÄ±r.' } ]; }
      current = cases[0]; step=0; answers=[]; score=0; render();
    }
    function render(){
      document.getElementById('case-title').textContent = current.title || 'Mini-Case';
      document.getElementById('case-step').textContent = `${step+1}/1`;
      document.getElementById('case-context').textContent = current.context || '';
      document.getElementById('case-question').textContent = current.vraag || '...';
      const opts = document.getElementById('case-options'); opts.innerHTML='';
      (current.opties||[]).forEach((o,i)=>{ const b=document.createElement('button'); b.className='option-btn'; b.textContent=o; b.onclick=()=>{ answers[step]=i; updateNav(); }; if(answers[step]===i) b.classList.add('selected'); opts.appendChild(b); });
      updateNav();
    }
    function updateNav(){
      document.getElementById('case-prev').disabled = step===0;
      const answered = answers[step]!==undefined; document.getElementById('case-next').disabled = !answered;
      document.getElementById('case-end').style.display = answered? 'block':'none';
    }
    function prev(){ if(step>0){ step--; render(); } }
    function next(){ if(step<0){ step++; render(); } }
    function end(){
      score = answers[0]=== (typeof current.best==='number'? current.best:0) ? 1: 0;
      const result = { date: new Date().toISOString().split('T')[0], time:new Date().toLocaleTimeString('nl-NL'), category:'case', score, total:1, percentage: score*100, type:'case' };
      const list = JSON.parse(localStorage.getItem('quizResults')||'[]'); list.unshift(result); localStorage.setItem('quizResults', JSON.stringify(list.slice(0,100)));
      localStorage.setItem('lastQuizResult', JSON.stringify({ type:'case', score, total:1, percentage: score*100, questions:[{ vraag: current.vraag, opties: current.opties, userIndex: answers[0], correctIndex: current.best, uitleg: current.uitleg||'' }] }));
      location.href='resultaten.html';
    }
    document.addEventListener('DOMContentLoaded', ()=>{
      load();
      document.getElementById('case-prev').addEventListener('click', prev);
      document.getElementById('case-next').addEventListener('click', next);
      document.getElementById('case-end').addEventListener('click', end);
    });
  </script>
</body>
</html>